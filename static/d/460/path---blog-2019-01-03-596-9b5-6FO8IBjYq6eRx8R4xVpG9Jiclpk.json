{"data":{"markdownRemark":{"html":"<h1>Overview</h1>\n<ul>\n<li>Debian 9</li>\n<li>shadowsocks-libev (<a href=\"https://github.com/shadowsocks/shadowsocks-libev\">Github</a>)</li>\n<li>simple-obfs (<a href=\"https://github.com/shadowsocks/simple-obfs\">Github</a>)</li>\n</ul>\n<h1>Todo</h1>\n<h2>Install Debian 9</h2>\n<p>☕️</p>\n<h2>Install shadowsocks-libev</h2>\n<pre><code class=\"language-bash\">    sh -c 'printf \"deb http://deb.debian.org/debian stretch-backports main\" > /etc/apt/sources.list.d/stretch-backports.list'\n    apt update\n\n    apt -t stretch-backports install shadowsocks-libev\n</code></pre>\n<h2>Use shadowsocks-libev</h2>\n<pre><code class=\"language-bash\">    systemctl status shadowsocks-libev\n    systemctl start shadowsocks-libev\n    systemctl stop shadowsocks-libev\n    systemctl restart shadowsocks-libev\n</code></pre>\n<p>or</p>\n<pre><code class=\"language-bash\">    service shadowsocks-libev status\n    service shadowsocks-libev start\n    service shadowsocks-libev stop\n    service shadowsocks-libev restart\n</code></pre>\n<p>or</p>\n<pre><code class=\"language-bash\">    ss-server -c /etc/shadowsocks-libev/config.json\n</code></pre>\n<h2>Config of shadowsocks-libev</h2>\n<pre><code class=\"language-bash\">    vi /etc/shadowsocks-libev/config.json\n</code></pre>\n<pre><code class=\"language-json\">    {\n        \"server\":[\"0.0.0.0\"],\n        \"mode\":\"tcp_and_udp\",\n        \"server_port\":443,\n        \"local_port\":1080,\n        \"password\":\"\",\n        \"timeout\":60,\n        \"method\":\"chacha20-ietf-poly1305\"\n    }\n</code></pre>\n<ul>\n<li>\n<p>Tip</p>\n<p>改完记得重启服务</p>\n</li>\n</ul>\n<h2>Client</h2>\n<ul>\n<li>os x → ShadowsocksX-NG</li>\n<li>android → shadowsocks+simple-obfs</li>\n<li>ios → shadowrocket</li>\n</ul>\n<p>如果加了混淆，配置如下</p>\n<pre><code>    plugin:obfs-local;\n    plugin-opt:obfs=tls;obfs-host:amazon.com\n</code></pre>\n<h1>Faster?</h1>\n<h2>Enable Google BBR</h2>\n<p>这就是使用Debian 9的原因，不用换内核</p>\n<pre><code class=\"language-bash\">    echo \"net.core.default_qdisc=fq\" >> /etc/sysctl.conf\n    echo \"net.ipv4.tcp_congestion_control=bbr\" >> /etc/sysctl.conf\n    sysctl -p\n</code></pre>\n<p>执行下面三条指令，出现bbr说明启用了</p>\n<pre><code class=\"language-bash\">    sysctl net.ipv4.tcp_available_congestion_control\n    sysctl net.ipv4.tcp_congestion_control\n    lsmod | grep bbr\n</code></pre>\n<h2>Config of TCP</h2>\n<pre><code class=\"language-txt\">    // config.txt\n    net.core.default_qdisc = fq\n    net.ipv4.tcp_congestion_control = bbr\n    net.ipv4.tcp_fastopen = 3\n    \n    fs.file-max = 1024000\n    net.core.rmem_max = 67108864\n    net.core.wmem_max = 67108864\n    net.core.rmem_default = 65536\n    net.core.wmem_default = 65536\n    net.core.netdev_max_backlog = 4096\n    net.core.somaxconn = 4096\n    net.ipv4.tcp_syncookies = 1\n    net.ipv4.tcp_tw_reuse = 1\n    net.ipv4.tcp_tw_recycle = 0\n    net.ipv4.tcp_fin_timeout = 30\n    net.ipv4.tcp_keepalive_time = 1200\n    net.ipv4.ip_local_port_range = 10000 65000\n    net.ipv4.tcp_max_syn_backlog = 4096\n    net.ipv4.tcp_max_tw_buckets = 5000\n    net.ipv4.tcp_rmem = 4096 87380 67108864\n    net.ipv4.tcp_wmem = 4096 65536 67108864\n    net.ipv4.tcp_mtu_probing = 1\n    net.ipv4.ip_forward = 1\n\n    cat config.txt >> /etc/sysctl.conf\n    sysctl -p\n</code></pre>\n<h1>Safe??</h1>\n<h2>Install simple-obfs</h2>\n<pre><code class=\"language-bash\">    apt -t stretch-backports install simple-obfs\n\n    vi /etc/shadowsocks-libev/config.json\n</code></pre>\n<p>添加两个字段</p>\n<pre><code class=\"language-json\">    {\n        \"plugin\": \"obfs-server\",\n        \"plugin_opts\": \"obfs=tls;failover:127.0.0.1:80\"\n    }\n</code></pre>\n<p>重启ss服务</p>\n<h2>Install nginx</h2>\n<pre><code class=\"language-bash\">    apt install nginx\n\n    systemctl status nginx\n</code></pre>\n<p>nginx默认监听80端口</p>\n<p>浏览器访问<ip>:443将自动跳转至nginx首页</p>\n<h1>Something Useful</h1>\n<p>查看端口</p>\n<pre><code class=\"language-bash\">    netstat -ntpl\n</code></pre>","frontmatter":{"date":"January 03, 2019","path":"/blog/2019-01-03","title":"科学上网"}}},"pageContext":{}}